<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GWNU 게시판</title>
    <style>
        #loginBtn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        #loginBtn:hover {
            background-color: #0056b3;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        #container {
            max-width: 800px;
            margin: 0 auto;
        }
        h1, h2 {
            text-align: center;
        }
        #boardList {
            margin-bottom: 20px;
            text-align: center;
        }
        #boardList button {
            margin: 5px;
            padding: 10px 15px;
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }
        #boardList button:hover {
            background-color: #0056b3;
        }
        #postList, .post-form {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        #postList ul {
            list-style: none;
            padding: 0;
        }
        #postList ul li {
            padding: 10px;
            border-bottom: 1px solid #ddd;
            position: relative;
        }
        #postList ul li:last-child {
            border-bottom: none;
        }
        .post-form input, .post-form textarea {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .post-form button {
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
        }
        .post-form button:hover {
            background-color: #0056b3;
        }
        .comments {
            margin-top: 10px;
            padding-left: 20px;
        }
        .comment-form {
            margin-top: 10px;
        }
        .comment-form input {
            width: calc(100% - 100px);
            padding: 8px;
        }
        .comment-form button {
            padding: 8px 15px;
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="container">
        <h1>GWNU 게시판</h1>
        <!-- 로그인 버튼 -->
        <button id="loginBtn">로그인</button>
        <!-- 게시판 선택 버튼 -->
        <div id="boardList">
            <h2>게시판 선택</h2>
            <button onclick="selectBoard('board1')">기숙사 게시판</button>
            <button onclick="selectBoard('board2')">동아리 게시판</button>
            <button onclick="selectBoard('board3')">수업 게시판</button>
            <button onclick="selectBoard('board4')">학과 게시판</button>
        </div>

        <!-- 선택한 게시판의 게시물 리스트 -->
        <div id="postList" style="display: none;">
            <h2 id="boardTitle">게시물 리스트</h2>
            <ul id="postItems">
                <!-- 게시물이 여기에 동적으로 추가됩니다. -->
            </ul>
        </div>

        <!-- 게시물 작성 및 수정 폼 -->
        <div class="post-form" style="display: none;">
            <h2>새 게시물 작성</h2>
            <input type="hidden" id="editIndex" value="">
            <input type="text" id="postTitle" placeholder="제목을 입력하세요">
            <textarea id="postContent" rows="3" placeholder="내용을 입력하세요"></textarea>
            <button id="addPostBtn">게시물 작성</button>
            <button id="updatePostBtn" style="display: none;">게시물 수정</button>
        </div>
    </div>

    <script>
        // 로그인 버튼 클릭 시 로그인 페이지로 이동
        const loginBtn = document.getElementById('loginBtn');
        loginBtn.addEventListener('click', function() {
            window.location.href = 'html/user/login.html'; // 로그인 페이지로 이동
        });
        let currentBoard = ''; // 현재 선택된 게시판 ID
        const postItems = document.getElementById('postItems');
        const postTitle = document.getElementById('postTitle');
        const postContent = document.getElementById('postContent');
        const addPostBtn = document.getElementById('addPostBtn');
        const updatePostBtn = document.getElementById('updatePostBtn');
        const editIndexInput = document.getElementById('editIndex');
        const postListDiv = document.getElementById('postList');
        const postFormDiv = document.querySelector('.post-form');

        // 게시판 선택 함수
        function selectBoard(boardId) {
            currentBoard = boardId;
            document.getElementById('boardTitle').innerText =' 게시물 리스트';
            postListDiv.style.display = 'block';
            postFormDiv.style.display = 'block';
            renderPosts(); // 게시물 리스트 렌더링
        }

        // 로컬 스토리지에서 게시물 불러오기
        function getPosts() {
            return JSON.parse(localStorage.getItem(currentBoard)) || [];
        }

        // 게시물 리스트 렌더링 함수
        function renderPosts() {
            const storedPosts = getPosts();
            postItems.innerHTML = '';
            if (storedPosts.length > 0) {
                storedPosts.forEach((post, index) => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <strong>${post.title}</strong> <br> 
                        ${post.content} <br> 
                        <small>${post.date}</small>
                        <span class="edit" onclick="editPost(${index})">수정</span>
                        <span class="delete" onclick="deletePost(${index})">삭제</span>

                        <!-- 댓글 리스트 -->
                        <div class="comments">
                            <h4>댓글</h4>
                            <ul id="commentList_${index}">
                                ${post.comments.map(comment => `<li>${comment}</li>`).join('')}
                            </ul>
                            <!-- 댓글 입력 폼 -->
                            <div class="comment-form">
                                <input type="text" id="commentInput_${index}" placeholder="댓글을 입력하세요">
                                <button onclick="addComment(${index})">댓글 작성</button>
                            </div>
                        </div>
                    `;
                    postItems.appendChild(li);
                });
            } else {
                postItems.innerHTML = '<li>게시물이 없습니다.</li>';
            }
        }

        // 게시물 작성 버튼 클릭 시 호출
        addPostBtn.addEventListener('click', function() {
            const title = postTitle.value;
            const content = postContent.value;

            if (title && content) {
                const storedPosts = getPosts();
                storedPosts.push({
                    title: title,
                    content: content,
                    date: new Date().toLocaleDateString(),
                    comments: []
                });

                // 로컬 스토리지에 저장
                localStorage.setItem(currentBoard, JSON.stringify(storedPosts));

                // 입력 필드 초기화
                postTitle.value = '';
                postContent.value = '';

                // 게시물 리스트 다시 렌더링
                renderPosts();
            } else {
                alert('제목과 내용을 입력하세요.');
            }
        });

        // 게시물 삭제
        function deletePost(index) {
            const storedPosts = getPosts();
            if (confirm('정말 이 게시물을 삭제하시겠습니까?')) {
                storedPosts.splice(index, 1);
                localStorage.setItem(currentBoard, JSON.stringify(storedPosts));
                renderPosts();
            }
        }

        // 게시물 수정
        function editPost(index) {
            const storedPosts = getPosts();
            const post = storedPosts[index];
            postTitle.value = post.title;
            postContent.value = post.content;
            editIndexInput.value = index;

            // 버튼 전환
            addPostBtn.style.display = 'none';
            updatePostBtn.style.display = 'block';
        }

        // 게시물 수정 버튼 클릭 시 호출
        updatePostBtn.addEventListener('click', function() {
            const storedPosts = getPosts();
            const index = editIndexInput.value;
            const title = postTitle.value;
            const content = postContent.value;

            if (title && content) {
                storedPosts[index] = {
                    title: title,
                    content: content,
                    date: new Date().toLocaleDateString(),
                    comments: storedPosts[index].comments // 기존 댓글 유지
                };

                // 로컬 스토리지에 저장
                localStorage.setItem(currentBoard, JSON.stringify(storedPosts));

                // 입력 필드 초기화
                postTitle.value = '';
                postContent.value = '';
                editIndexInput.value = '';

                // 버튼 전환
                addPostBtn.style.display = 'block';
                updatePostBtn.style.display = 'none';

                // 게시물 리스트 다시 렌더링
                renderPosts();
            } else {
                alert('제목과 내용을 입력하세요.');
            }
        });

        // 댓글 추가
        function addComment(postIndex) {
            const storedPosts = getPosts();
            const commentInput = document.getElementById(`commentInput_${postIndex}`);
            const commentText = commentInput.value;

            if (commentText) {
                storedPosts[postIndex].comments.push(commentText);
                localStorage.setItem(currentBoard, JSON.stringify(storedPosts));
                commentInput.value = ''; // 입력값 초기화
                renderPosts();
            } else {
                alert('댓글을 입력하세요.');
            }
        }

        // 페이지 로드 시 기본 게시판 선택
        selectBoard('board1');
    </script>
</body>
</html>
